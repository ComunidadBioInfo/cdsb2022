[["index.html", "Workshop CDSB 2022: An√°lisis avanzado de metagenomas. Creando tus flujos de an√°lisis con R/Bioconductor. Bienvenida 0.1 Instructores 0.2 Ponentes invitados 0.3 Ayudantes 0.4 Temario 0.5 Patrocinadores 0.6 Licencia", " Workshop CDSB 2022: An√°lisis avanzado de metagenomas. Creando tus flujos de an√°lisis con R/Bioconductor. Dra. Mirna V√°zquez Rosas-Landa, Dra. Yalbi Balderas-Mart√≠nez, Dra. Joselyn Ch√°vez, M.C. Erick Cuevas-Fern√°ndez, Dra. Alejandra Medina-Rivera, Dr.¬†Leonardo Collado-Torres, Dr.¬†Brett Baker, Dra. Valerie de Anda Bienvenida Les damos la bienvenida al Workshop An√°lisis avanzado de metagenomas. Creando tus flujos de an√°lisis con R/Bioconductor! En los √∫ltimos a√±os la metagen√≥mica ha cobrado una gran importancia para el descubrimiento de nuevos grupos microorganismos y rutas metab√≥licas. En este taller revisaremos los m√©todos m√°s recientes para analizar datos metagen√≥micos, usando herramientas de software libre y paquetes de R especializados que est√°n disponibles libremente v√≠a Bioconductor. Durante este taller aprender√°s a reconstruir genomas a partir de metagenomas utilizando diferentes herramientas de software libre. Revisaremos diferentes estrategias de binning y de predicci√≥n metab√≥lica, identificaremos √°reas de oportunidad para el desarrollo de software en metagen√≥mica, aprender√°s tambi√©n c√≥mo documentar tu c√≥digo utilizando RMarkdown. 0.1 Instructores Dra. Mirna V√°zquez Rosas Landa: Estancia Postdoctoral en la Universidad de Texas en Austin. Dra. Yalbi Balderas Mart√≠nez: Investigadora en el Instituto Nacional de Enfermedades Respiratorias Ismael Cos√≠o Villegas. Dra. Joselyn Ch√°vez Fuentes: Estancia Postdoctoral en Icahn School of Medicine at Mount Sinai. M.C. Erick Cuevas Fern√°ndez: Estudiante de Doctorado en la Universidad Nacional Aut√≥noma de M√©xico. Dra. Alejandra Medina Rivera: Investigadora Asociada en el Laboratorio Internacional de Investigaci√≥n de Medicina Gen√≥mica, UNAM. 0.2 Ponentes invitados Dr.¬†Brett Baker: Investigador en la Universidad de Texas en Austin. Dra. Valerie de Anda: Investigadora Asociada en la Universidad de Texas en Austin. Dr.¬†Leonardo Collado-Torres 0.3 Ayudantes M.C. Diana Oaxaca M.C. Marisol Navarro M.C. Jos√© Antonio Ovando Dr.¬†Otoniel Maya Lucas 0.4 Temario Consulta el calendario de este curso en: https://bit.ly/calendarcdsb2022 0.4.1 Lunes 01 de agosto Horario Tema Instructor 09:00-09:30 Bienvenida. Comit√© organizador EBM 2022 09:30-10:30 Presentaci√≥n de la CDSB. Comit√© organizador CDSB 2022 11:00-12:00 Pl√°tica: La √∫ltima versi√≥n del √°rbol de la vida y la metagen√≥mica. Dr.¬†Brett Baker 12:00-14:00 Control de versiones con GitHub y RStudio. Dra. Alejandra Medina 15:00-17:00 Generaci√≥n de Reportes con R markdown. M.C Erick Cuevas Fern√°ndez y Dra. Joselyn Ch√°vez 0.4.2 Martes 02 de agosto Horario Tema Instructor 9:00-10:00 Pl√°tica: Convirtiendo tu flujo de an√°lisis en un paquete de R/Bioconductor. Dr.¬†Leonardo Collado Torres 10:00-11:00 Introducci√≥n a Conda Dr.¬†Otoniel Maya Lucas 11:30-13:00 Reconstrucci√≥n de genomas. Parte I Binning M.C. Diana Oaxaca y Dra. Mirna Vazquez Rosas Landa 13:00-14:00 Pl√°tica: Paquetes de bioconductor relacionados con la metagen√≥mica. Dra. Yalbi Balderas 15:00-17:00 Reconstrucci√≥n de genomas. Parte II Dra. Yalbi Balderas 0.4.3 Mi√©rcoles 03 de agosto Horario Tema Instructor 9:00-10:30 Asignaci√≥n taxon√≥mica. Dra. Mirna V√°zquez 11:30-13:30 An√°lisis de v√≠as metab√≥licas. Parte I Dra. Mirna V√°zquez y Dra. Yalbi Balderas 15:00-17:00 An√°lisis de v√≠as metab√≥licas. Parte II Dra. Mirna V√°zquez y Dra. Yalbi Balderas 0.4.4 Jueves 04 de agosto Horario Tema Instructor 9:00-11:00 Un vistazo a la creaci√≥n de paquetes de R/Bioconductor Dra. Joselyn Ch√°vez 11:30-14:00 Proyecto colaborativo. Parte I Dra. Mirna V√°zquez, Dra. Yalbi Balderas, Dra. Joselyn Ch√°vez, M.C. Erick Cuevas 15:00-17:00 Proyecto colaborativo. Parte II Dra. Mirna V√°zquez, Dra. Yalbi Balderas, Dra. Joselyn Ch√°vez, M.C. Erick Cuevas 0.4.5 Viernes 05 de agosto Horario Tema Instructor 9:00-11:00 Proyecto colaborativo Parte III Dra. Mirna V√°zquez, Dra. Yalbi Balderas, Dra. Joselyn Ch√°vez, Dra. Erick Cuevas 11:30-13:30 Presentaci√≥n de proyectos Dra. Mirna V√°zquez, Dra. Yalbi Balderas, Dra. Joselyn Ch√°vez, Dra. Erick Cuevas 13:30-14:00 Clausura Organizadores CDSB 2022 0.5 Patrocinadores Agradecemos a nuestros patrocinadores: 0.6 Licencia Este material posee una licencia tipo Creative Commons Attribution-ShareAlike 4.0 International License. Para conocer m√°s sobre esta licencia, visite http://creativecommons.org/licenses/by-sa/4.0/ "],["keynote-la-√∫ltima-versi√≥n-del-√°rbol-de-la-vida-y-la-metagen√≥mica.html", "1 Keynote: La √∫ltima versi√≥n del √°rbol de la vida y la metagen√≥mica 1.1 Diapositivas", " 1 Keynote: La √∫ltima versi√≥n del √°rbol de la vida y la metagen√≥mica Dr.¬†Brett Baker 01 de agosto de 2022 1.1 Diapositivas "],["control-de-versiones-con-github-y-rstudio.html", "2 Control de versiones con GitHub y RStudio 2.1 Diapositivas 2.2 ¬øPor qu√© hacer control de versiones de nuestros proyectos? 2.3 Git 2.4 GitHub 2.5 Manual de sobreviviencia con Git Y GitHub en RStudio (en caso de ser necesario) 2.6 Credenciales HTTPS en Cache 2.7 Conectando RStudio con Git y Github. 2.8 GitHub primero, RStudio despu√©s‚Ä¶ 2.9 RStudio primero y GitHub tambi√©n 2.10 Proyecto existente, GitHub al final", " 2 Control de versiones con GitHub y RStudio Dr.¬†Alejandra Medina; M. C. Erick Cuevas-Fern√°ndez 01 de agosto de 2022 div.color { border-radius: 5px; padding: 20px; margin: 30px 0px 30px;} div.red { background-color:#f67155; } div.orange{ background-color:#f0BB51;} div.pair { display: flex; flex-direction: row; justify-content: center; text-align:center; padding:0px} div.inside { width: 49%; padding: 0px} div.scroll { max-height: 400px; overflow-y: auto; background: #111111; border-radius:5px; padding: 10px; margin: 30px 0px 30px; color: #999999;} div.alert{color:#bd475d; background-color:transparent} Este documento se basa en ‚ÄúHappy Git with R‚Äù de Jenny Bryan, los STAT 545 TAs, Jim Hester https://happygitwithr.com 2.1 Diapositivas Puedes encontrar las diapositivas aqu√≠. 2.2 ¬øPor qu√© hacer control de versiones de nuestros proyectos? ‚úÖ Los proyectos suelen cambiar y crecer. üíæ Es d√≠ficil saber cu√°les fueron todos los cambios a lo largo del tiempo (en especial tiempos largos, hazlo por tu yo del futuro!). ü§î Las colaboraciones se pueden complicar sin un buen control de versiones. üîê Seguridad. 2.3 Git Git es un sistema de control de versiones Git funciona con GitHub, Bitbucket o GitLab ¬øPor qu√© usar Git en vez de solo renombrar los archivos? ‚úÖ‚úÖPor qu√© es mejor tener una filogenia del archivo. Git es un sistema de control de versiones distribuido, gratuito y de c√≥digo abierto, dise√±ado para manejar todo tipo de proyectos, desde los m√°s peque√±os hasta los m√°s grandes, con rapidez y eficiencia. Git es f√°cil de aprender y ocupa poco espacio con un rendimiento rapid√≠simo. Supera a las herramientas SCM como Subversion, CVS, Perforce y ClearCase con caracter√≠sticas como la ramificaci√≥n local barata, las c√≥modas √°reas de preparaci√≥n y los m√∫ltiples flujos de trabajo. 2.3.1 Git vs controles de versi√≥n a mano Con Git cada contribuidor tiene una copia del repositorio central, con todos los archivos y la historia de los cambios por los que han pasado. Excuse me, do you have a moment to talk about version control?, Jennifer Bryan, 2017 ‚ö†Ô∏è NO OLVIDES TENER INSTALADO Git, en caso de que a√∫n no lo hayas instalado, lo puedes descargar en el siguiente enlace https://git-scm.com/downloads. Para conocer la localizaci√≥n y la versi√≥n de Git que tienes en tu computadora, corre el siguiente comando en la terminal: which git y git --version 2.4 GitHub GitHub es una plataforma para guardar proyectos, hace uso de Git. Su principal utilidad es para generar c√≥digo fuente de programas. ‚ö†Ô∏è NO OLVIDES TENER UNA CUENTA EN GITHUB, en caso de que a√∫n no lo hayas hecho, puedes ir la p√°gina de GitHub y seleccionar join. Es indispensable tu usuario para los ejercicios que siguen. Tambi√©n existen otras plataformas como Bitbucked y GitLab, las cuales funcionan de manera similar a GitHub. 2.5 Manual de sobreviviencia con Git Y GitHub en RStudio (en caso de ser necesario) Por cualquier problema con la conexi√≥n entre RStudio y Git, siempre ten en cuenta la ubicaci√≥n de d√≥nde se instal√≥ Git. Puedes usar en la terminal which git (Mac y Linux) O bien usar en la terminal where git (Windows) Recuerda que la terminal (o l√≠nea de comandos √≥ consola √≥ shell √≥ bash) es un programa en tu computadora que funciona para correr otros programas. Desde RStudio puedes abrir la terminal, lo cual es muy conveniente si est√°s trabajando en un proyecto. Puedes abrir una terminal con: Tools &gt; Terminal (abre la terminal dentro del IDE de RStudio) Tools &gt; Shell (abre una terminal externa a RStudio) La recomendaci√≥n actual de GitHub es usar HTTPS porque es la manera m√°s f√°cil de configurar y tiene operabilidad en multiples redes y plataformas. Es menos probable que HTTPS sea bloqueado por un firewall. Una conexi√≥n HTTPS permite que credential.helper almacene en cach√© su contrase√±a. (por tanto puedes configurar tu usuario y contrase√±a en tu equipo de uso) Es m√°s sencillo acceder a un repositorio desde cualquier lugar, ya que solo necesita los detalles de su cuenta (no se requieren claves SSH) para escribir en el repositorio. Usualmente cuando inicies un proyecto colaborativo con GitHub inicializa el ropositorio con un README. Copia el HTTPS URL para clonar el repositorio en la terminal git clone https://github.com/TU-USUARIO/TU-REPOSITORIO.git. 2.6 Credenciales HTTPS en Cache Puedes crear un token de acceso personal, PAT (PERSONAL ACCESS TOKEN), esa ser√° tu credencial para HTTPS. Es una alternativa al uso de contrase√±as para la autenticaci√≥n en GitHub cuando utilizas la API de GitHub o la l√≠nea de comandos. Como precauci√≥n de seguridad, GitHub elimina autom√°ticamente los tokens de acceso personales que no se han usado durante un a√±o. OJO PARA FINES DEL CURSO POR AHORA NO GENERAREMOS UN TOKEN, este proceso realizalo cuando tengas planificado donde guardar tu contrase√±a y trabajes con una computado personal. ¬øC√≥mo crear un token? Ve a tu perfil de GitHub, dale click a la imagen de perfil (usualmente en la esquina superior derecha), y busca la opci√≥n de settings √≥ configuraci√≥n seg√∫n sea la configuraci√≥n de idioma que tengas. Da click a continuaci√≥n en Developer settings √≥ Par√°metros del desarrollador. En la barra lateral izquierda da click en Tokens de acceso personal. Haz click en Generar un nuevo token. As√≠gna un nombre descriptivo a tu token. Selecciona los alcances o permisos que deseas otorgarle a este token. Para usar tu token para acceder a repositorios desde la l√≠nea de comando, selecciona repo. Finalmente haz click en generar token. Listo, copia y pega tu token en el lugar d√≥nde siempre lo puedas volver a copiar, ya que por razones de seguridad, una vez salgas de la p√°gina no podr√°s volver a ver el token. Nota: Preserva tus tokens de la misma manera que tus contrase√±as y no se las reveles a nadie. Cuando trabajes con la API, usa tokens como variables del entorno en lugar de codificarlos de forma r√≠gida en tus programas. Una vez que tengas un token, puedes ingresarlo en lugar de tu contrase√±a cuando realices operaciones de Git a trav√©s de HTTPS. El punto final es que una vez configurada una PAT, varios paquetes de R, incluidos usethis y gh, podr√°n trabajar con la API de GitHub en su nombre, de forma autom√°tica. Por lo tanto, una PAT configurada correctamente significa que todo esto funcionar√° a la perfecci√≥n: - Operaciones HTTPS remotas a trav√©s de la l√≠nea de comando Git y, por lo tanto, a trav√©s de RStudio - Operaciones HTTPS remotas a trav√©s del paquete gert R y, por lo tanto, usethis - Operaciones de la API de GitHub a trav√©s del paquete gh R y, por lo tanto, usethis ¬øC√≥mo crear un token desde R? Puedes ir directamente a la p√°gina de GitHub a la parte para generar tu token de acceso personal mediante la siguiente funci√≥n: usethis::create_github_token() Y con las opciones que se mencionaban anteriormente puedes configurar y crear tu PAT. Si lo que quieres especificar tu PAT en RStudio, las siguientes funciones te ser√°n √∫tiles: library(gitcreds) gitcreds_set() library(credentials) set_github_pat() Para eliminar credenciales utiliza la funci√≥n credentials::git_credential_forget() 2.6.1 Actividad Ejecuta los c√≥digos PERO no generes para tu PAT por ahora. 2.7 Conectando RStudio con Git y Github. Para lo que sigue a continuaci√≥n, deber√≠as tener esto: Tener una cuenta en GitHub R y RStudio actualizados Git instalado Saber que desde la terminal puedes hacer push y pull 2.8 GitHub primero, RStudio despu√©s‚Ä¶ Crea un repositorio en GitHub: mi_repositorio &gt; Public &gt; YES initialize this repository with a README &gt; clicken el gran bot√≥n verde ‚ÄúCreate repository‚Äù En RStudio crea un nuevo proyecto: File &gt; New Project &gt; Version Control &gt; Git. Ahi pega el URL del repositorio https://github.com/mi_usuario/mi_repositorio.git. Da click en Create Project. Esto nos generar√° los siguientes elementos: Un directorio nuevo Un repositorio Git enlazado a al repositorio de GitHub Un proyecto en RStudio Con este procedimiento ya no es necesario preocuparse por configurar controles remotos Git y rastrear ramas en la l√≠nea de comandos. 2.8.1 Actividad Genera un repositorio con el nombre que desees. Y con√©ctalo a RStudio. Cerciorate de que el archivo README se encuentre en tu nueva carpeta. Usa la funci√≥n usethis::use_r(\"titulo_de_un_script\") y observa lo que sucede. PAUSA ¬øC√≥mo comento y doy push/pull desde RStudio? 2.8.2 Comentar, pull y push Con la flecha azul podemos hacer pull (RECUERDA HACERLO ANTES DE HACER UN PUSH), y con la flecha verde un push. Para poder comentar y hacer push debemos marcar con una flechita mediante un click en las peque√±as cajas blancas de la columna Staged, damoc click en commit lo cual no abre la siguiente ventana. Volvemos a dar click en commit, y finalizamos con push (flecha verde). 2.8.3 Actividad Usa el c√≥digo dir.create(\"mis_imagenes\") en la consola de tu sesi√≥n de RStudio (la que est√° vinculada a tu repositorio). Ejecuta el siguiente c√≥digo quitando los #: data(MASS::cats) # pdf(&quot;mis_imagenes/cats_plot.pdf&quot;) ggplot(cats, aes(x = Sex)) + geom_bar(fill = &quot;orange&quot;, color = &quot;black&quot;) + theme_classic() + xlab(&quot;Sexo&quot;) + ylab(&quot;N√∫mero de Gatos&quot;) + ggtitle(&quot;Gatos&quot;) # dev.off() Comenta y da push a los cambios que realizaste en el repositorio. 2.9 RStudio primero y GitHub tambi√©n Usa uno de los proyectos que hayas generado en las sesiones anteriores, PERO, que no est√© enlazado a GitHub. Ahora veremos como conectar un proyecto de R existente con GitHub. Realiza los pasos que hicimos en GitHub primero, RStudio despu√©s pero asegurate de crear un repositorio con un nuevo nombre. Y LISTO!! usa un simple ctrl + c, √≥ mv √≥ click derecho + copiar √≥ el m√©todo que prefieras para mover o copiar archivos. Copia los archivos de tu antig√ºo proyecto al proyecto nuevo. Solo haz commit y push y listo, lo que ten√≠a en tu antig√ºo proyecto ya est√° enlazado a GitHub. 2.9.1 Actividad Por equipos de 3 personas: Copia y pega los archivos que generaste en el Repositorio que se comparti√≥ en el ‚ÄúDrive‚Äù (elijan uno de los tres repositorios) en un respositorio conectado a GitHub. Todos clonen un repositorio de GitHub en com√∫n. Enlacelo a GitHub y sigan el procedimiento de RStudio primero y GitHub tambi√©n. Seleccionen con que datos quieren trabajar por equipo: gapminder mtcars cats Creen una carpeta para guardar imagenes. Por persona generen un grafico representativo de su dataset, guardelo en la carpeta de imagenes. Compartan entre el equipo sus creaciones al hacer commit/pull/push. 2.10 Proyecto existente, GitHub al final Supongamos que tenemos un proyecto de R existente en alg√∫n lugar de nuestra computadora. NOTA: Para generar proyecto de RStudio desde la consola puedes utilizar el siguiente c√≥digo: usethis::create_project() O en RStudio con File &gt; New Project &gt; Existing Directory Si su proyecto ya es un proyecto de RStudio, ejec√∫telo. ¬øYa es un repositorio de Git? La presencia del panel de Git deber√≠a alertarlo. Si es as√≠, ha terminado. Sino este es el primer camino a seguir: Con el p√°quete usethis usa la funci√≥n usethis::use_git En RStudio ve a Tools &gt; Project Options &gt; Git/SVN. Dentro de Version control system, selecciona Git. Y da click a ‚ÄúYes‚Äù cuando aparezca ‚ÄúConfirm New Git Repository?‚Äù. Si usaste RStudio o usethis, el proyecto deber√≠a reiniciarse en RStudio. Hazlo tu mismo si hizo git init. RStudio ahora deber√≠a tener un panel Git. 2.10.1 Breviario cultural con los PATs Si usas el paquete usethis Y has configurado un token de acceso personal (PAT) de GitHub has esto en R: usethis::use_github() Esto crear√° un nuevo repositorio en GitHub, lo agregar√° como un control remoto, configurar√° una rama de seguimiento y lo abrir√° en su navegador. Lea la ayuda de use_github() para conocer sus argumentos y consejos sobre c√≥mo configurar una PAT. Esto es extremadamente √∫til para una variedad de flujos de trabajo que llaman a la API de GitHub. Considere configurar esto si usa usethis, devtools o gh con regularidad. Volviendo al tema de Proyecto existente, GitHub al final. Otra opci√≥n que se puede hacer para conectar un proyecto existen a GitHub es ir a hacer un repositorio a GitHub PERO ten en cuenta los siguientes cambios: Elije un nombre de repositorio; probablemente deber√≠a coincidir con el nombre de su proyecto y directorio local. NO inicialice este repositorio con un archivo README. Todo lo dem√°s es igual a los pasos que hac√≠amos en GitHub primero, RStudio despu√©s‚Ä¶ Ahora ve a tu proyecto de RStudio, has clic en los ‚Äúdos cuadros de color p√∫rpura y un cuadrado blanco‚Äù en el panel de Git. Has clic en ‚ÄúAgregar control remoto‚Äù. Pegue la URL aqu√≠ y elija un nombre remoto, casi con certeza el origin. Ahora ‚ÄúADD‚Äù. Pasado esto deberiamos volver en el cuadro de di√°logo ‚ÄúNew Branch‚Äù. Ingresa ‚Äúmaster‚Äù como el nombre de la rama y aseg√∫rate de que la opci√≥n ‚ÄúSync branch with remote‚Äù est√© marcada. Haz clic en ‚ÄúCreate‚Äù. En el siguiente cuadro de di√°logo elije ‚Äúoverwrite‚Äù. Ahora solo haz commit/pull/push y c√©rciorate que FUNCIONE!! 2.10.2 Actividad Por equipos hagan lo siguiente: Usa un proyecto que no est√© enlazado a GitHub. Genera un repositorio que tenga el mismo nombre de tu proyecto siguiendo las instrucciones recientes. Enlaza tu repositorio con el proyecto existente. ¬°QUE LA FUERZA TE ACOMPA√ëE! "],["generaci√≥n-de-reportes-con-r-markdown..html", "3 Generaci√≥n de Reportes con R Markdown. 3.1 Introducci√≥n a R Markdown 3.2 Creaci√≥n de presentaciones y libros con R Markdown", " 3 Generaci√≥n de Reportes con R Markdown. M.C Erick Cuevas Fern√°ndez y Dra. Joselyn Ch√°vez 01 de agosto de 2022 div.color { border-radius: 5px; padding: 20px; margin: 30px 0px 30px;} div.red { background-color:#f67155; } div.orange{ background-color:#f0BB51;} div.pair { display: flex; flex-direction: row; justify-content: center; text-align:center; padding:0px} div.inside { width: 49%; padding: 0px} div.scroll { max-height: 400px; overflow-y: auto; background: #111111; border-radius:5px; padding: 10px; margin: 30px 0px 30px; color: #999999;} div.alert{color:#bd475d; background-color:transparent} 3.1 Introducci√≥n a R Markdown Este documento se basa en: Advanced R Markdown Workshop rstudio::conf 2019 R Markdown Cookbook 3.1.1 Diapositivas Puedes encontrar las diapositivas aqu√≠. 3.1.2 ¬øQu√© es y para que sirve R Markdown? RMarkdown facilita armar un marco de autor√≠a para ciencia de datos. Facilita la reproducibilidad del c√≥digo, al permitir generar texto y c√≥digo en conjunto. Tiene la bondad de soportar multiples formatos para guardar y ejecutar c√≥digo, asi como para generar informes de alta calidad que se pueden compartir. Su estructura b√°sica consta de: YAML, nos permite dise√±ar la configuraci√≥n de nuestro archivo markdown. YAML es un lenguaje de serializaci√≥n de datos. Cuenta con funciones de Perl, C, XML, HTML. Se basa en el formato JSON. Markdown, aqu√≠ escribiremos el texto y el c√≥digo que vamos a compartir en el reporte, se pueden a√±adir graficos, tablas, imagenes, etc. B√°sicamente esta es la estructura b√°sica de un RMarkdown: YAML --- title: &quot;Bienvenido CDSB 2022&quot; author: &quot;EMB 2022&quot; date: &quot;2022-08-01&quot; output: html_document --- Markdown Parrafo de R Markdown. Esto es un fragmento de c√≥digo o &quot;chunk&quot;: ```r fit = lm(dist ~ speed, data = cars) b = coef(fit) plot(cars) abline(fit) ``` &lt;img src=&quot;_main_files/figure-html/unnamed-chunk-19-1.png&quot; width=&quot;672&quot; /&gt; La pendiente de la regresi√≥n es -17.5790949. 3.1.3 Ejemplos de uso Entre las cosas que se pueden hacer con RMarkdown es lo siguiente: 3.1.4 Agregar en un informe la informaci√≥n de una localizaci√≥n library(leaflet) leaflet() %&gt;% addTiles() %&gt;% setView(lat = 18.95, lng = -99.239, zoom = 13) 3.1.5 Poner la chicharronera (F√≥rmula cuadr√°tica en un texto) Esto es la chicharronera dentro de un texto \\[x = \\frac {-b \\pm \\sqrt {b^2 - 4ac}}{2a}\\] Y puedo seguir describiendo lo que siga haciendo. \\[\\text{La F√≥rmula Cuadr√°tica es }x = \\frac {-b \\pm \\sqrt {b^2 - 4ac}}{2a}\\] RPubs Generar correos personalizados Escribir art√≠culos rticles Escribir Libros Escribir tesis Crear sitios web 3.1.6 Crear un archivo .Rmd File &gt; New_file &gt; R Markdown... 3.1.7 Ejemplos Los ejemplos de sintaxis los puedes ver a detalle en las diapositivas. 3.2 Creaci√≥n de presentaciones y libros con R Markdown 3.2.1 Diapositivas Basado en ‚ÄúR Markdown: The Definitive Guide‚Äù ‚Äúbookdown: Authoring Books and Technical Documents with R Markdown‚Äù 3.2.2 El paquete xaringan Instalaci√≥n: install.packages(&quot;xaringan&quot;) Creaci√≥n de una nueva presentaci√≥n: File &gt; New file &gt; R Markdown &gt; From Template &gt; Ninja Presentation 3.2.3 Previsualizaci√≥n de las diapositivas infinite_moon_reader() xaringan::inf_mr() 3.2.4 La diapositiva de t√≠tulo Modificando la diapositiva de t√≠tulo Otros temas: chocolate, duke, fc, hygge, ki, lucy, metropolis, middlebury, nhsr, robot, uio, useR, uwm, wic. 3.2.5 Diapositivas de contenido Ejecutando c√≥digo 3.2.6 Incluyendo im√°genes El tama√±o de la imagen se puede modificar usando las opciones out.width, out.height, fig.width, fig.height. Las dimensiones se indican como porcentaje o como n√∫mero de pixeles. 3.2.7 Alineaci√≥n del contenido Afectando todo el contenido de la diapositiva class: center class: middle Afectando contenido espec√≠fico .center[] .pull-left[] .pull-right[] 3.2.8 Compartiendo la presentaci√≥n Como p√°gina web Generar el archivo html usando Knit &gt; Publicar usando GitHub pages Como pdf Generar el archivo html usando Knit &gt; Convertir a pdf usando pagedown pagedown::chrome_print(&quot;presentacion.html&quot;) Nota: Es necesario mantener el ratio original de las diapositivas. 3.2.9 Informaci√≥n adicional https://bookdown.org/yihui/rmarkdown/xaringan.html 3.2.10 Creaci√≥n de libros con bookdown Instalaci√≥n: install.packages(&quot;bookdown&quot;) Descarga alguno de los ejemplos: https://github.com/yihui/bookdown-minimal https://github.com/rstudio/bookdown-demo 3.2.11 Templado a utilizar https://github.com/ComunidadBioInfo/templado_bookdown/ 3.2.12 Agregando contenido Cada archivo Rmd representa un cap√≠tulo Los cap√≠tulos van ordenados/numerados No se deben renderizar los Rmd Las im√°genes llamadas dentro de los cap√≠tulos se colocan en img Para incluir las im√°ges se usa: knitr::include_graphics(‚Äúimg/imagen.png‚Äù) Los archivos html llamados dentro de los cap√≠tulos se colocan en docs 3.2.13 Publicando el libro Renderizado &gt; Publicaci√≥n con GitHub pages bookdown::render_book() Los html correspondientes a los cap√≠tulos se renderizan de manera autom√°tica en docs El libro quedar√° disponible en https://comunidadbioinfo.github.io/templado_bookdown/ 3.2.14 Configuraci√≥n del repositorio 3.2.15 Informaci√≥n adicional https://bookdown.org/yihui/bookdown/ "],["keynote-convirtiendo-tu-flujo-de-an√°lisis-en-un-paquete-de-rbioconductor..html", "4 Keynote: Convirtiendo tu flujo de an√°lisis en un paquete de R/Bioconductor. 4.1 Diapositivas", " 4 Keynote: Convirtiendo tu flujo de an√°lisis en un paquete de R/Bioconductor. Dr.¬†Leonardo Collado Torres 02 de agosto de 2022 4.1 Diapositivas Puedes encontrar las diapositivas aqu√≠. "],["introducci√≥n-a-conda..html", "5 Introducci√≥n a Conda. 5.1 ¬øQu√© es conda? 5.2 conda 101", " 5 Introducci√≥n a Conda. @zorbax 02 de agosto de 2022 5.1 ¬øQu√© es conda? De acuerdo a la definici√≥n oficial: conda: A package manager helps you find and install packages. Entonces, es un gestor/instalador de paquetes. Se obtiene mediante Anaconda o Miniconda. La instalaci√≥n depender√° del sistema operativo a utilizar. Aunque conda est√° disponible para Windows, macOS y Linux, no todos los paquetes disponibles para bioinform√°tica son compatibles entre los tres sistemas, siendo la prioridad de paquetes Linux &gt; macOS y en algunos casos, al final, Windows. 5.2 conda 101 conda info Actualizar conda conda update conda Listar todos los entornos de conda conda env list Actualizar todos los paquetes de conda (base) conda update conda --all Agregar canales conda config --add channels r conda config --add channels conda-forge conda config --add channels bioconda Buscar un paquete conda search PACKAGE Instalar un paquete en el entorno base conda install PACKAGE Eliminar archivos temporales conda clean --all -y Actualizar todos los paquetes del entorno actual conda update --all -y Eliminar entorno conda remove -n qiime2 --all Crear un entorno con versiones espec√≠ficas conda create -y -n test3.6 python=3.6 pandas=1.0 Crear entorno a partir de un archivo YAML conda env create -f environment.yml conda con vitaminas: mamba conda install -yc conda-forge mamba mamba create -y -n testpy3.6 python=3.6 pandas=1.0 mamba create -y -n testR3.6 r-base=3.6 "],["el-grupo-de-datos.html", "6 El grupo de datos", " 6 El grupo de datos M.C. Diana Oaxaca y Dra. Mirna Vazquez Rosas Landa 02 de agosto de 2022 6.0.1 Datos Los datos con los que trabajaremos se enlistan en la siguiente tabla. samples BioProject Article htn PRJEB13870 Gut microbiota dysbiosis contributes to ‚Ä¶ biogas PRJEB21678 Genetic repertoires of anaerobic microbiomes ‚Ä¶. pulque PRJNA603591 Genomic profiling of bacterial and fungal ‚Ä¶ sedimento PRJNA364776 Microbial Dark Matter project phase II * tea PRJNA698063 Niche differentiation of microbes‚Ä¶‚Ä¶) 6.0.1.1 htn Sinopsis: Se realiz√≥ secuenciaci√≥n metagen√≥mica de heces de pacientes sanos (control), con pre-hipertensi√≥n (pHTN) y con hipertensi√≥n (HTN). Los pacientes con enfermedad presentaron niveles de diversidad dr√°sticamente m√°s bajos en comparaci√≥n con el grupo control. Tambi√©n hicieron trasplantes fecales de pacientes enfermos a ratones ax√©nicos, el efecto del trasplante demostr√≥ que la hipertensi√≥n observada en los ratones era derivada de la microbiota trasplantada. Los datos crudos: PRJEB13870 https://www.ebi.ac.uk/ena/browser/view/PRJEB13870?show=reads El art√≠culo: Gut microbiota dysbiosis contributes to the development of hypertension sobre microbioma e hipertensi√≥n https://link.springer.com/article/10.1186/s40168-016-0222-x#Ack1 Li, J., Zhao, F., Wang, Y. et al.¬†Gut microbiota dysbiosis contributes to the development of hypertension. Microbiome 5, 14 (2017). https://doi.org/10.1186/s40168-016-0222-x 6.0.1.2 pulque. Sinopsis: En este trabajo se secuenciaron librerias de Illumina MiSeq de muestras a diferentes tiempos de fermentaci√≥n: 0 hrs (aguamiel), 3, 6 y 12 horas. En general observaron que la abundancia de los g√©neros cambi√≥ durante la fermentaci√≥n y se asoci√≥ con una disminuci√≥n de sacarosa, aumento de etanol y √°cido l√°ctico (Medidos por HPLC). Predijeron, entre otros, la bios√≠ntesis de folato y vitamina B. Uno de los MAG obtenidos correspondi√≥ a Saccharomyces cereviseae relacionado filogen√©ticamente con S. cerevisiae aislado de sake y bioetanol y otro correspondi√≥ a Zymomonas mobilis que propusieron como un nuevo linaje. Los datos crudos: PRJNA603591 https://www.ebi.ac.uk/ena/browser/view/PRJNA603591 El articulo: Genomic profiling of bacterial and fungal communities and their predictive functionality during pulque fermentation by whole-genome shotgun sequencing https://www.nature.com/articles/s41598-020-71864-4 Chac√≥n-Vargas, K., Torres, J., Giles-G√≥mez, M. et al.¬†Genomic profiling of bacterial and fungal communities and their predictive functionality during pulque fermentation by whole-genome shotgun sequencing. Sci Rep 10, 15115 (2020). https://doi.org/10.1038/s41598-020-71864-4 6.0.1.3 sedimento Microbioma de sedimento del Microbial Dark Matter project (MDMP) Sinopsis: El MDMP es realizado por el Departamento de Energ√≠a del JGI, se enfoca en resolver nuevos superphyla de bacterias y arqueas, en la fase uno se secuenciaron 201 linajes enriquecidos no cultivados, mediante single cell sequencing. En esta segunda fase se utilizaron datos p√∫blicos de diferentes muestras y regiones del mundo. A√∫n se siguen procesando datos y hasta el momento han encontrado prometedores SAGs inclu√≠do un phylum novedoso en Deward Creek. Los datos: PRJNA364776 https://www.ebi.ac.uk/ena/browser/view/PRJNA364776 El proyecto: Microbial Dark Matter project phaseII https://www.osti.gov/award-doi-service/biblio/10.46936/10.25585/60000876 Hedlund, Brian ORCID [1] Woyke, Tanja ORCID [2] Pester, Michael ORCID [3] Spear, John ORCID [4] Hallam, Steven ORCID [5] Eisen, Jonathan [6] Elshahed, Mostafa ORCID [7] Becraft, Eric [8] Dunfield, Peter [9] Teske, Andreas [10] van Heerden, et al.¬†Joint Genome Institute Award. 6.0.1.4 tea Microbioma de Camellia sinensis (la planta del t√© verde y negro) Sinopsis: En este trabajo se secuenciaron librerias de Illumina de muestras rizosf√©ricas y endof√≠ticas de C. sinensis, el estudio hace una descripci√≥n general de la taxonom√≠a y predicci√≥n funcional del microbioma, hace √©nfasis en las diferencias encontradas en la parte endof√≠tica y rizosf√©ricas. Los datos: PRJNA698063 https://www.ebi.ac.uk/ena/browser/view/PRJNA698063 El art√≠culo: Niche differentiation of microbes and their functional signatures in Assam type tea (Camellia sinensis var. assamica) https://www.researchsquare.com/article/rs-347764/v1 Bora, S. S., Dey, K. K., Borah, M., Rahman, M., Gogoi, M., Modi, M. K., &amp; Barooah, M. (2021). Niche differentiation of microbes and their functional signatures in Assam type tea (Camellia sinensis var. assamica). "],["mapeo-y-binning.html", "7 Mapeo y Binning 7.1 Secuenciaci√≥n 7.2 Control de calidad 7.3 Ensamble 7.4 Mapeo 7.5 Binning 7.6 Refinamiento", " 7 Mapeo y Binning M.C. Diana Oaxaca y Dra. Mirna Vazquez Rosas Landa 02 de agosto de 2022 7.1 Secuenciaci√≥n El ADN ambiental se secuencia utilizando alguna plataforma de secuenciacion o varias: Ilumina PacBio Nanopore 7.2 Control de calidad Del proceso de secuenciacion se recuperan lecturas de aproximadamente 300 bps. Las secuencias las recortamos para eliminar artefactos generados durante el proceso de secuenciaci√≥n. Aqu√≠ algunas herramientas utilizadas: FastQC Trimmomatic fastp 7.3 Ensamble Las lecturas se ensamblan para armar contigs y scaffolds. Existen diferentes programas para ensamblar metagenomas, aqu√≠ algunos de ellos: MEGAHIT IDBA MetaSPAdes 7.3.1 Discutamos https://docs.google.com/document/d/1iiw-q-90nATg-RNTd9nU8L1XE5xoDRC6j19JC1GiPIk/edit?usp=sharing 7.4 Mapeo Profundidad: La profundidad de cada contig se calcula mapeando las lecturas al ensamble. Este paso permite evaluar la calidad del ensable y es necesario para hacer la reconstrucci√≥n de genomas ya que, como veremos m√°s adelante, es uno de los par√°metros que toman en cuenta los ‚Äúbineadores‚Äù. Vamos a mapear utilizando la herramienta BBMap del programa BBtools. Y samtools. ¬°Manos a la obra! Con√©ctate al servidor: ssh USER@hpc-matematicas-z.fciencias.unam.mx Crea tu carpeta y una liga simb√≥lica a los datos: mkdir -p 01.Mapeo/{data,results} cd 01.Mapeo/ ln -s /home/diana/samples/htn/data/htn.fasta data/ ln -s /home/mirna/03.Mapeo/01.Trimm_reads/htn*.fastq data/ Primero, activa tu ambiente de conda. conda activate bbmap_env ¬°Ahora s√≠! Explora las opciones de bbmap, y vamos a hacer nuestro primer mapeo. bbmap.sh ref=data/htn.fasta in1=data/htn_1-short.fastq in2=data/htn_2-short.fastq out=results/htn.sam kfilter=22 subfilter=15 maxindel=80 cd results samtools view -bShu htn.sam | samtools sort -@ 94 -o htn_sorted.bam samtools index htn_sorted.bam 7.4.1 Discutamos https://docs.google.com/document/d/1iiw-q-90nATg-RNTd9nU8L1XE5xoDRC6j19JC1GiPIk/edit?usp=sharing 7.5 Binning Utilizaremos varios programas para hacer la reconstrucci√≥n de los genomas y haremos una comparaci√≥n de estos. NOTA: Cada programa tiene una ayuda y un manual de usuario, es importante revisarlo y conocer cada par√°metro que se ejecute. En terminal se puede consultar el manual con el comando man y tambi√©n se puede consultar la ayuda con -h o --help, por ejemplo fastqc -h. La presente pr√°ctica s√≥lo es una representaci√≥n del flujo de trabajo, sin embargo, no sustituye los manuales de cada programa y el flujo puede variar dependiendo del tipo de datos y pregunta de investigaci√≥n. 7.5.1 MaxBin Crea tu espacio de trabajo y una liga s√≠mb√≥lica hacia los datos que se usar√°n: mkdir -p 02.MaxBin/{data,results} cd 02.MaxBin/ ln -s /home/diana/samples/htn/data/htn.fasta data/ ln -s /home/diana/samples/htn/data/htn-depth.txt data/ Okay, ahora activa tu ambiente. conda activate maxbin_env Explora las opciones y ahora s√≠, a calcular bins. run_MaxBin.pl -contig data/htn.fasta -out results/maxbin -abund data/htn-depth.txt -max_iteration 2 7.5.2 MetaBat Okay vamos a utilizar otro progama. Crea tus ligas simb√≥licas :) mkdir -p 03.Metabat/{data,results} cd 03.Metabat/ ln -s /home/diana/samples/htn/data/htn.fasta data/ ln -s /home/diana/samples/htn/data/htn_sorted.bam data/ Para MetaBat lo primero que tenemos que hacer es crear un archivo de profundidad utilizando el script jgi_summarize_bam_contig_depths. Entonces, primero activamos el ambiente. conda activate metabat_env Como cualquier otro programa jgi_summarize_bam_contig_depths tiene opciones, podemos revisarlas. jgi_summarize_bam_contig_depths --outputDepth data/htn-depth.txt data/htn_sorted.bam Okay‚Ä¶ exploremos el archivo con head head data/htn-depth.txt Para metabat s√≥lo necesitamos dos archivos principales: El ensamble El archivo de profundidad metabat -i data/htn.fasta -a data/htn-depth.txt -o results/bins -t 4 --minCVSum 0 --saveCls -d -v --minCV 0.1 -m 2000 7.5.3 CONCOCT Okay, vamos a utilizar otro programa. Crea tus ligas simb√≥licas :) mkdir -p 04.Concoct/{data,results} cd 04.Concoct/ ln -s /home/diana/samples/htn/data/htn.fasta data/ ln -s /home/diana/samples/htn/data/htn_sorted.bam data/ Primero, activemos el ambiente conda activate concoct_env Primero, los contigs se tienen que partir en pedazos m√°s peque√±os cut_up_fasta.py data/htn.fasta -c 10000 -o 0 --merge_last -b results/SplitAssembly-htn.bed &gt; results/htn.fasta-split10K.fa Para crear la tabla de cobertura se necesita primero indexar el archivo bam samtools index data/htn_sorted.bam concoct_coverage_table.py results/SplitAssembly-htn.bed data/htn_sorted.bam &gt; results/concoct_coverage_table_htn.tsv ¬°Ahora s√≠! A correr concoct. Normalmente correr√≠amos 500 iteraciones, pero esta vez s√≥lo haremos una. concoct --coverage_file results/concoct_coverage_table_htn.tsv --composition_file results/htn.fasta-split10K.fa --clusters 400 --kmer_length 4 --threads 4 --length_threshold 3000 --basename concot --seed 4 --iterations 1 Combinar contigs merge_cutup_clustering.py concot_clustering_gt3000.csv &gt; results/merged-htn-gt3000.csv Extraer bins como fasta individualmente mkdir results/bins-concot extract_fasta_bins.py data/htn.fasta results/merged-htn-gt3000.csv --output_path results/bins-concot 7.5.4 Discutamos https://docs.google.com/document/d/1iiw-q-90nATg-RNTd9nU8L1XE5xoDRC6j19JC1GiPIk/edit?usp=sharing 7.6 Refinamiento 7.6.1 DASTool Preparing input files. Fasta_to_Scaffolds2Bin.sh -i /home/mirna/05.Concoct/bins-concot -e fa &gt; htn_concot.scaffolds2bin.tsv Fasta_to_Scaffolds2Bin.sh -i /home/mirna/04.Metabat2 -e fa &gt; htn.scaffolds2bin.tsv PATH=/home/programs:$PATH /home/programs/DAS_Tool-1.1.2/DAS_Tool -i htn_maxbin.contigs2bin.tsv,htn_metabat.scaffolds2bin.tsv,htn_concoct.scaffolds2bin.tsv -l maxbin,metabat,concoct -c data/htn.fasta -o results/htn_bins --debug -t 4 --search_engine diamond --write_bins 1 7.6.2 CheckM Muy bien, crea un nuevo directorio y entra en √©l. mkdir 06.CheckM cd 06.CheckM/ Ahora activemos el ambiente. conda activate checkm_env checkm lineage_wf -t 4 -x fa /home/mirna/05.DAS_tool/results/htn_bins_DASTool_bins DAStools-log_htn -f CheckM-DAS_Tool_bins.txt Vamos a explorar la salida de checkM Primero me puedes decir ¬øCu√°ntas lineas tiene tu archivo? Okay‚Ä¶ ahora vamos a remover esas lineas feas. sed -e &#39;1,3d&#39; CheckM-DAS_Tool_bins.txt | sed -e &#39;37d&#39; &gt;CheckM-DAS_Tool_bins_mod.txt library(tidyverse) # CheckM -------------------------------------------------------------------#### checkm&lt;-read.table(&quot;CheckM-DAS_Tool_bins_mod.txt&quot;, sep = &quot;&quot;, header = F, na.strings =&quot;&quot;, stringsAsFactors= F) # Extracting good quality bins Megahit ------------------------------------#### colnames(checkm)&lt;-c(&quot;Bin_Id&quot;, &quot;Marker&quot;, &quot;lineage&quot;, &quot;Number_of_genomes&quot;, &quot;Number_of_markers&quot;, &quot;Number_of_marker_sets&quot;, &quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;Completeness&quot;, &quot;Contamination&quot;, &quot;Strain_heterogeneity&quot;) good_bins&lt;-checkm %&gt;% select(Bin_Id, Marker, Completeness, Contamination) %&gt;% filter(Completeness &gt;= 50.00) %&gt;% filter(Contamination &lt;= 10.00) Okay‚Ä¶ quiz√° podamos recuperar algunos m√°s. medium_bins&lt;-checkm %&gt;% select(Bin_Id, Marker, Completeness, Contamination) %&gt;% filter(Completeness &gt;= 50.00) %&gt;% filter(Contamination &lt;= 20.00) Muy bien, vamos a extraer esos bins. bins&lt;-medium_bins$Bin_Id write.table(bins, &quot;lista_medium_bins&quot;, quote = F, row.names = F, col.names = F) 7.6.3 Mis Bins mkdir -p 08.Bins/{Genoma,Proteoma} cd 08.Bins sed &#39;s#bin#cp /home/mirna/05.DAS_tool/results/htn_bins_DASTool_bins/bin#g&#39; lista_medium_bins | sed &#39;s#$#.fa .#g&#39; &gt; copy_bins.sh Ahora un ejercicio. grep &quot;&gt;&quot; *.fa ¬øCu√°l es el problema? change_bin_name&lt;-function(ruta, ambiente){ ruta_original&lt;-getwd() setwd(ruta) filez &lt;- list.files() newname&lt;-paste0(ambiente, &quot;_&quot;, filez) file.rename(from=filez, to=newname) filez &lt;- list.files() file.rename(from=filez, to=sub(pattern=&quot;\\\\.&quot;, replacement=&quot;_&quot;, filez)) setwd(ruta_original) } change_bin_name(&quot;/home/mirna/07.Bins/Genoma&quot;, &quot;htn&quot;) library(phylotools) library(tidyverse) add_names_to_seqs &lt;- function(nombre_del_archivo){ filenames &lt;- unlist(strsplit(nombre_del_archivo, &quot;/&quot;)) filenames &lt;- filenames[[grep(&quot;fa&quot;, filenames)]] divide &lt;- unlist(strsplit(filenames, &quot;\\\\.&quot;)) bin_name &lt;- divide[1] termination &lt;- divide[2] old_name &lt;- get.fasta.name(nombre_del_archivo) new_name &lt;- paste0( bin_name, &quot;-scaffold-&quot;, old_name) ref2 &lt;- data.frame(old_name, new_name) out_file &lt;- paste0(bin_name, &quot;_renamed&quot;, &quot;.&quot;, termination) rename.fasta(infile = nombre_del_archivo, ref_table = ref2, outfile = out_file) } files &lt;- list.files(&quot;.&quot;) files &lt;- paste0(&quot;/home/mirna/07.Bins/Genoma/&quot;, files) map(files, add_names_to_seqs) Veamos si funcion√≥ grep &quot;&gt;&quot; *.fa Muy bien, pongamos eso en una nueva carpeta y esperemos lo mejor jaja. No es cierto, s√≠ mov√°moslo a otra carpeta, pero quitemos el renamed. change_bin_name&lt;-function(ruta){ ruta_original&lt;-getwd() setwd(ruta) filez &lt;- list.files() file.rename(from=filez, to=sub(pattern=&quot;_renamed&quot;, replacement=&quot;&quot;, filez)) setwd(ruta_original) } change_bin_name(&quot;/home/mirna/07.Bins/Genoma/01.Bins_named&quot;) ¬øCreen que puedan optimizar esos scripts? ¬°Discute en tu equipo si tienes una mejor idea! "],["keynote-paquetes-de-bioconductor-relacionados-con-la-metagen√≥mica.html", "8 Keynote: Paquetes de bioconductor relacionados con la metagen√≥mica", " 8 Keynote: Paquetes de bioconductor relacionados con la metagen√≥mica Dra. Yalbi Balderas 02 de agosto de 2022 "],["taxonom√≠a.html", "9 Taxonom√≠a 9.1 Leamos los datos", " 9 Taxonom√≠a Dra. Mirna Vazquez Rosas Landa 03 de agosto de 2022 Vamos a explorar la taxonom√≠a de estos bins con GTDB-tk. mkdir 11.GTDBTK Activemos el ambiente conda activate gtdbtk-2.1.0 Indiquemos d√≥nde est√° la base de datos: export GTDBTK_DATA_PATH=/home/programs/DB/release207_v2 Explora la ayuda de GTDB-tk Discutamos: https://docs.google.com/document/d/1iiw-q-90nATg-RNTd9nU8L1XE5xoDRC6j19JC1GiPIk/edit?usp=sharing Excelente, ahora en equipos vamos a correr GTDB-tk. gtdbtk classify_wf --genome_dir /home/mirna/07.Bins/Genoma/01.Bins_named --out_dir /home/mirna/11.GTDBTK --cpus 4 -x fa Vamos a visualizar los datos. Todos a R!! 9.1 Leamos los datos library(tidyverse) GTDBK&lt;-read.table(&quot;11.GTDBTK/gtdbtk.bac120.summary.tsv&quot;, sep = &quot;\\t&quot;, header = T, na.strings =&quot;&quot;, stringsAsFactors= F)%&gt;% as_tibble() htn_gtdbtk&lt;-GTDBK %&gt;% select(user_genome, classification) %&gt;% separate(classification, c(&quot;Domain&quot;, &quot;Phylum&quot;, &quot;Class&quot;, &quot;Order&quot;, &quot;Family&quot;, &quot;Genus&quot;, &quot;Species&quot;), sep= &quot;;&quot;) %&gt;% rename(Bin_name=user_genome) %&gt;% unite(Bin_name_2, c(&quot;Bin_name&quot;, &quot;Phylum&quot;), remove = FALSE) %&gt;% select(Bin_name, Domain, Phylum, Class, Order, Family, Genus, Species) Par√©ntesis, vamos a imprimir esta tabla para convertirla en metadatos. write.table(htn_gtdbtk, file = &quot;11.GTDBTK/Metadatos.txt&quot;, sep=&quot;\\t&quot;, quote = F, row.names = F, col.names = T) Vamos a hacer un plot GTDBtk&lt;-htn_gtdbtk %&gt;% count(Domain, Phylum) %&gt;% rename(Number_of_MAGs = n) %&gt;% ggplot(aes(x = Domain, y = Number_of_MAGs, fill = Phylum)) + geom_bar(stat = &quot;identity&quot;, position=position_dodge())+ theme_minimal() Puede ser interactivo tambi√©n. library(plotly) GTDBtk_p_fig &lt;- ggplotly(GTDBtk) "],["inferencia-metab√≥lica.html", "10 Inferencia metab√≥lica 10.1 KEEG 10.2 Explorando el metabolismo con rbims. 10.3 Anotaci√≥n con InterproScan", " 10 Inferencia metab√≥lica Dra. Mirna Vazquez Rosas Landa 03 de agosto de 2022 Vamos a utilizar prodigal para predecir las prote√≠nas: for i in /home/mirna/07.Bins/Genoma/01.Bins_named/*.fa ; do prodigal -i $i -o $i.txt -a $i.faa ; done Veamos un poco la salida grep &quot;&gt;&quot; *.faa 10.1 KEEG Okay, ahora vamos a utilizar kofam_scan para anotar las prote√≠nas. Vamos a dividirnos en equipos para hacer la anotaci√≥n de los bins! Esto es como lo har√≠amos para uno: /home/programs/DB/kofam/kofam_scan-1.3.0/exec_annotation -o /home/mirna/08.Kofamscan/htn_bins_63.fa.faa.txt /home/mirna/07.Bins/Proteoma/htn_bins_63.fa.faa --report-unannotated --cpu 4 En un loop lo podr√≠amos hacer as√≠: for i in *.faa ; do /home/programs/DB/kofam/kofam_scan-1.3.0/exec_annotation -o /home/mirna/08.Kofamscan/$i.txt $i --report-unannotated --cpu 4; done Okay antes de correrlo, vamos a crear dos carpetas nuevas y unas ligas simb√≥licas. mkdir -p 08.Kofamscan/{01.Proteomas,02.KO_results} cd 08.Kofamscan/ ln -s /home/mirna/07.Bins/Proteoma/*.faa 01.Proteomas Ajusta el loop para correr KofamScan con los genomas que te tocan :) 10.2 Explorando el metabolismo con rbims. Vamos a hacer una exploraci√≥n r√°pida del metabolismo con rbims. Okay iniciamos con la librer√≠a de Rbims library(rbims) library(tidyverse) Ahora, vamos a leer los resultados de KEEG y mapearlos con el resto de la base de datos de KEEG htn_mapp&lt;-read_ko(&quot;08.Kofamscan/02.KO_results/&quot;) %&gt;% mapping_ko() Okay, vamos a enfocarnos en los metabolismos encargados de la obtenci√≥n de energ√≠a. Overview&lt;-c(&quot;Central Metabolism&quot;, &quot;Carbon Fixation&quot;, &quot;Nitrogen Metabolism&quot;, &quot;Sulfur Metabolism&quot;, &quot;Fermentation&quot;, &quot;Methane Metabolism&quot;) Energy_metabolisms_htn&lt;-htn_mapp %&gt;% drop_na(Cycle) %&gt;% get_subset_pathway(rbims_pathway, Overview) Vamos a visualizar los datos. plot_bubble(tibble_ko = Energy_metabolisms_htn, x_axis = Bin_name, y_axis = Pathway_cycle, analysis=&quot;KEGG&quot;, calc=&quot;Percentage&quot;, range_size = c(1,10), y_labs=FALSE, x_labs=FALSE) Okay, incorporemos metadatos, por ejemplo la taxonom√≠a. Metadatos&lt;-read_delim(&quot;11.GTDBTK/Metadatos.txt&quot;, delim=&quot;\\t&quot;) Hagamos un plot plot_bubble(tibble_ko = Energy_metabolisms_htn, x_axis = Bin_name, y_axis = Pathway_cycle, analysis=&quot;KEGG&quot;, data_experiment = Metadatos, calc=&quot;Percentage&quot;, color_character = Class, range_size = c(1,10), y_labs=FALSE, x_labs=FALSE) Ahora, vamos a explorar una sola v√≠a Secretion_system_htn&lt;-htn_mapp %&gt;% drop_na(Cycle) %&gt;% get_subset_pathway(Cycle, &quot;Secretion system&quot;) Y hagamos un heatmap plot_heatmap(tibble_ko=Secretion_system_htn, y_axis=Genes, analysis = &quot;KEGG&quot;, calc=&quot;Binary&quot;) Ahora agreguemos metadatos plot_heatmap(tibble_ko=Secretion_system_htn, y_axis=Genes, data_experiment = Metadatos, order_x = Phylum, analysis = &quot;KEGG&quot;, calc=&quot;Binary&quot;) plot_heatmap(tibble_ko=Secretion_system_htn, y_axis=Genes, data_experiment = Metadatos, order_y = Pathway_cycle, order_x = Phylum, analysis = &quot;KEGG&quot;, calc=&quot;Binary&quot;) 10.3 Anotaci√≥n con InterproScan for i in $(ls *.faa); do sed -i &quot;s/\\*//g&quot; $i; done for i in $(ls *.faa); do interproscan.sh -cpu 4 -goterms -pa -i $i &gt; Log_Interpro_Scan_$i.txt; done Okay‚Ä¶ vamos a juntar todo en un solo. cat *.tsv &gt; htn_interpro.tsv Vamos a R library(rbims) library(tidyverse) interpro_Interpro_profile&lt;-read_interpro( data_interpro = &quot;09.Interpro/01.Proteomas/htn_interpro.tsv&quot;, database=&quot;INTERPRO&quot;, profile = T) %&gt;% filter(!str_detect(INTERPRO, &quot;-&quot;)) important_INTERPRO&lt;-get_subset_pca(tibble_rbims=interpro_Interpro_profile, cos2_val=0.95, analysis=&quot;INTERPRO&quot;) plot_heatmap(important_INTERPRO, y_axis=INTERPRO, analysis = &quot;INTERPRO&quot;, distance = T) plot_heatmap(important_INTERPRO, y_axis=INTERPRO, analysis = &quot;INTERPRO&quot;, distance = F) 10.3.1 Finalmente podemos escribir esto en una tabla. write_metabolism(&quot;09.Interpro/01.Proteomas/htn_interpro.tsv&quot;, &quot;08.Kofamscan/02.KO_results/&quot;) "],["un-vistazo-a-la-creaci√≥n-de-paquetes-de-rbioconductor.html", "11 Un vistazo a la creaci√≥n de paquetes de R/Bioconductor 11.1 Diapositivas 11.2 Recapitulemos 11.3 Buenas pr√°cticas para escribir funciones 11.4 Documentaci√≥n 11.5 Archivos de prueba 11.6 Crear una vignette 11.7 Creado paquetes de forma colaborativa", " 11 Un vistazo a la creaci√≥n de paquetes de R/Bioconductor Dra. Joselyn Ch√°vez 04 de agosto de 2022 div.grey { background-color: #bfbfbf; } div.center { text-align:center; } 11.1 Diapositivas Material basado en - ‚ÄúR packages‚Äù by Hadley Wickham ‚ÄúBuilding Tidy Tools‚Äù by Charlotte and Hadley Wickham 11.2 Recapitulemos Revisar si podemos usar el nombre del paquete available::available(&quot;pkgMetagenomica&quot;) Crear la estructura inicial del paquete usethis::create_package(&quot;pkgMetagenomica&quot;) Podemos agregar la estructura de biocthis biocthis::use_bioc_pkg_templates() Pedir que Git ignore el archivo .Rproj usethis::use_git_ignore(&quot;*.Rproj&quot;) Crear el respositorio de GitHub usethis::use_github() Crear el archivo Description estilo Bioconductor biocthis::use_bioc_description() Crear el archivo README estilo Bioconductor biocthis::use_bioc_readme_rmd() devtools::build_readme() Recuerda guardar los cambios, hacer commit y push Crear el archivo NEWS estilo Bioconductor biocthis::use_bioc_news_md() Crear ayuda para usuarios y contribuidores biocthis::use_bioc_coc() usethis::use_tidy_contributing() biocthis::use_bioc_support() biocthis::use_bioc_issue_template() biocthis::use_bioc_citation() 11.3 Buenas pr√°cticas para escribir funciones Caracter√≠sticas del nombre de la funci√≥n: Cortos pero descriptivos Recomendable: Separar las palabras con _ Establecer una palabra en com√∫n al inicio para familias de funciones use_bioc_citation() # es mejor que citation() bioc_cit() usebioccitation() useBiocCitation() use.bioc.citation() Estructura recomendada de la funci√≥n: Indentar las l√≠neas de c√≥digo Agregar comentarios para separar/describir las secciones importantes Usar la sintaxis paquete::funcion() cuando hacemos llamado a funciones de otros paquetes 11.3.1 Ejercicio usethis::use_r(&quot;subset_heatmap&quot;) Generemos el c√≥digo de manera regular Simulemos una matriz con niveles de expresi√≥n de genes y grafiquemos los datos en un heatmap expresion_genes &lt;- matrix(rnorm(100), nrow = 10) rownames(expresion_genes) &lt;- paste0(&quot;gene_&quot;,letters[1:10]) colnames(expresion_genes) &lt;- paste0(&quot;especie_&quot;,letters[1:10]) library(ComplexHeatmap) Heatmap(expresion_genes, cluster_columns = FALSE, heatmap_legend_param = list(title = &quot;log2&quot;)) Escribamos una funci√≥n que permita seleccionar algunas especies/genes de inter√©s y genere el heatmap. library(ComplexHeatmap) subset_heatmap &lt;- function(x,especies=NULL,genes=NULL) { x_subset &lt;- x[genes,especies] Heatmap(expresion_genes, cluster_columns=FALSE, heatmap_legend_param=list(title=&quot;log2&quot;)) } Esta no es la mejor opci√≥n Un poco mejor: library(ComplexHeatmap) subset_heatmap &lt;- function(x, especies = NULL, genes = NULL) { x_subset &lt;- x[genes,especies] Heatmap(expresion_genes, cluster_columns = FALSE, heatmap_legend_param = list(title = &quot;log2&quot;)) } Mucho mejor: subset_heatmap &lt;- function(x, especies = NULL, genes = NULL) { # subset matrix x_subset &lt;- x[genes,especies] # plot heatmap ComplexHeatmap::Heatmap(x_subset, cluster_columns = FALSE, heatmap_legend_param = list(title = &quot;log2&quot;)) } subset_heatmap(expresion_genes, especies = c(&quot;especie_a&quot;, &quot;especie_b&quot;,&quot;especie_c&quot;), genes = c(&quot;gene_d&quot;,&quot;gene_e&quot;,&quot;gene_f&quot;)) 11.3.2 Actividad Escribe una funci√≥n que: - Filtre la matriz de expresi√≥n y mantenga s√≥lo los valores por encima de cierto valor. - Genere el heatmap filtrado Recuerda seguir las recomendaciones para escribir funciones. 11.4 Documentaci√≥n Descripci√≥n de los argumentos/par√°metros Ejemplos reproducibles Usaremos el paquete roxygen2 Coloca el cursor dentro de la funci√≥n. Usa la varita m√°gica para crear el esqueleto de documentaci√≥n de roxygen. Llena los campos de la documentaci√≥n: Para cada argumento/par√°metro se debe agregar la descripci√≥n, por ejemplo el tipo de objeto que esperas que el usuario introduzca. Describe lo que hace tu funci√≥n. Indica qu√© tipo de salida tendr√° la funci√≥n. Agrega un ejemplo sencillo y reproducible Una vez que terminamos de escribir la documentaci√≥n, generamos el archivo de ayuda devtools::document() Construye el paquete, despu√©s reinicia la sesi√≥n y carga tu paquete. devtools::build() Esto nos permitir√° consultar la ayuda de la funci√≥n usando help(subset_heatmap) ?subset_heatmap 11.4.1 Actividad Genera la documentaci√≥n de la funci√≥n que creaste para filtrar la matriz y graficar un heatmap. Comprueba que se pueda consultar la ayuda de tu funci√≥n. 11.5 Archivos de prueba ¬øPara qu√© nos sirven los archivos de prueba? Estar seguros que la funci√≥n tiene el comportamiento deseado Verificar que la funci√≥n es capaz de detectar las entradas correctas y reaccionar ante las entradas incorrectas. Verificar que la salida de la funci√≥n es la esperada. Detectar f√°cilmente cuando una actualizaci√≥n interna o externa rompe nuestro c√≥digo. Vamos a utilizar la funci√≥n subset_heatmap Ahora hagamos el archivo de pruebas: usethis::use_testthat() usethis::use_test(&quot;subset_heatmap&quot;) usethis::use_coverage() Pensemos en formas de romper nuestra funci√≥n: ¬øQu√© pasa si le damos como entrada un data frame? ¬øQu√© pasa si solamente le damos como entrada los genes y no las especies? ¬øQu√© pasa si el vector de especies o genes es num√©rico en lugar de caracter? Escribamos algunas pruebas: expresion_genes &lt;- matrix(rnorm(100), nrow = 10) rownames(expresion_genes) &lt;- paste0(&quot;gene_&quot;,letters[1:10]) colnames(expresion_genes) &lt;- paste0(&quot;especie_&quot;,letters[1:10]) test_that(&quot;Output is a ComplexHeatmap&quot;, { resultado &lt;- subset_heatmap(expresion_genes, especies = c(&quot;especie_a&quot;, &quot;especie_b&quot;,&quot;especie_c&quot;), genes = c(&quot;gene_d&quot;,&quot;gene_e&quot;,&quot;gene_f&quot;)) expect_s4_class(resultado, &quot;Heatmap&quot;) }) Eval√∫a la prueba usando: testthat::test_file(&quot;tests/testthat/test-subset_heatmap.R&quot;) Siguiente prueba: test_that(&quot;Empty argument genes are detected&quot;,{ expect_error(subset_heatmap(expresion_gene, especies = c(&quot;especie_a&quot;, &quot;especie_b&quot;,&quot;especie_c&quot;)) ) }) Una m√°s: test_that(&quot;Error with data frame works&quot;,{ expect_error(subset_heatmap(as.data.frame(expresion_genes)) ) }) Modifiquemos la funci√≥n para poder detectar errores: subset_heatmap &lt;- function(x, especies = NULL, genes = NULL) { # evalate class of x stopifnot(&quot;x must be a matrix&quot; = inherits(x, &quot;matrix&quot;)) # subset matrix x_subset &lt;- x[genes,especies] # plot heatmap ComplexHeatmap::Heatmap(x_subset, cluster_columns = FALSE, heatmap_legend_param = list(title = &quot;log2&quot;)) } Vuelve a correr el test: testthat::test_file(&quot;tests/testthat/test-subset_heatmap.R&quot;) 11.6 Crear una vignette Debe mostrar un flujo de an√°lisis explotando el potencial de tu paquete. Implementa tantas funciones de tu paquete como sea posible, pero no es necesari que incluya todas. Los datos a usar deben ser peque√±os o f√°ciles de acceder. Puedes crear m√∫ltiples vi√±etas para mostrar diferentes casos de an√°lisis y cubrir una mayor cantidad de funciones. biocthis::use_bioc_vignette(&quot;Introduccion_a_pkgMetagenomica&quot;) 11.7 Creado paquetes de forma colaborativa Agrega colaboradores a tu repositorio Ve al repositorio de tu paquete Entra a settings &gt; collaborators &gt; Add people Agrega el nombre de usuario de tu colaborador. Tu colaborador debe aceptar la invitaci√≥n que le llegar√° por correo electr√≥nico. 11.7.1 Actividad Agrega un colaborador al repositorio de tu paquete. P√≠dele que agregue un archivo de pruebas/test para la funci√≥n que creaste (filtra la matriz con valores mayores al que provee el usuario). Verifica que los cambios se ven reflejados en tu repositorio. Cambien de rol y agrega una nueva funci√≥n al repositorio de tu colega. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
